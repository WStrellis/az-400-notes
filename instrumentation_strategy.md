
# Logging

Apps running on Windows runtime can write logs either to the filesystem of their container or to Blob Storage. Apps running in Linux containers can only write logs to the docker filesystem.  

When file system logging is enabled it will only save logs for 12h(default) to prevent negative impacts on app performance.  

*Log File Locations*
- Windows - D:\LogFiles
    - Application/ - logs generated by the app if File System logging is enabled
    - DetailedErrors/ - Server logs if `Detailed` error messages are enabled
    - http/ - IIS-level logs if `Web Server logging` has been enabled
    - W3SVC<number>/ - details of failed http requests if `Failed Requests` has been enabled
- Blob Container - logs are stored in year, month, day , and hour folders
- Linux - logs are stored in underlying docker container that runs the app

# App Center
App Center is used to develop, build, test, and deploy mobile apps.  
It supports iOS, Android, UWP( universal windows platform), and tvOS apps. They  can be build in any language.

*Continuous Integration* - the practice of frequently running source code through various processes to ensure it is in a known-working state.

*Continuous Delivery* - the ability to deploy a new version of an app automatically to multiple environments.

### App Center Test
Runs automated UI tests on native and hybrid mobile apps. Run agains physical devices in a MS data center.  
- test results are maintained for six months

*Device Configuration* - combination of device model and operating system version  

*Device Tier* - tests can be run on a variety of real devices
- Tier 1 - popular mobile devices
- Tier 2 - less popular
- Tier 3 - uncommon devices


*Device Set* - collection of Device Configurations  

### Distribution
Apps can be distrubuted to users or an app store.
- *Distribution Group* - a collection of users who have access to a specific build(s) of an app. Members of a Distribution Group will receive email notifications about new releases.
    - Private - only users invited by email can access releases
    - Public - allows unauthenticated installed of a release from public links
- *Shared Distribution Group* - A Distribution Group that is used for multiple apps

### Diagnostics
The App Center SDK is available with resources to send app crash logs to App Center for analysis.  
- data can be stored for 90 or 28 days

### Storage Performance
Q: What does an "s" mean in the name of a vm size? Example: D2s_v3
A: An "s" denotes that the vm supportes Premium SSD drives

*Polyglot Persistence* - Using different storage technologies for different types of data.Example: Customer data in SQL, product reviews in MongoDB, app logs in Azure Blob storage.  

*Eventual Consistency* - When data is partitioned or replicated across multiple stores writes are only performed on one of those stores. A lock is not applied to the data. The other stores will be updated when all write actions are complete. This reduces the performance and cost overhead of performing locks. Reads may sometimes return out-of-date data.  

*Log Analytics Service* - aggregates logs from services across Azure and on-prem for analysis. Supports logging of custom metrics through a REST API.  

Azure Monitor Data Sources  
- App data
- Guest OS data - OS on which the app is running
- Azure Resource data
- Azure Subscription data
- Azure Tenant data

Application Insights
- SDK is added to apps
- SDK is used to send custom metrics to Application Insights service for analysis in portal


# Automation


*IaC* - Infrastructure as Code  
- *Imperative* - explicitly state the commands that are executed to produce the desired result. Example: shell script with Azure CLI or or an SDK.  
- *Declarative* - specify what the final result should be and let a program figure out which commands to execute. Example: ARM templates

ARM Template Sections:
- *Parameters* - handle input to template
- *Variables* - can be used throughout template
- *Resource* - what the template will create
- *Outputs* - details about what was created

### VM Deployment
- Custom Images - generated by creating a vm, configuring it, then creating an image from it. The image is then used as a base for new VMs.
    - requires separate process to keep images and vms up to date
- Post-Deployment Scripting - A basic image is deployed as a VM and then scripts are executed on the new VM to finish setting up the VM.
    - increases build time

# Application Insights
Monitors events and data in Azure Web Apps.
- *Runtime Instrumentation* - captures telemety without making changes to application code. Only available for apps running on Windows. Does not provide full functionality or data displays
- *Build-time Instrumentation* - The Application Insights SDK is added to the app. Enables all of the features and monitoring of custom events. Required for apps running on Linux.
- *Client-side Instrumentation* - Application Insights SDK is included in client-side pages.

When App Insights is enabled for a Web App the data generated by the app is stored in a seperate App Insights resource. This resource has an App Insights Dashboard for analyzing and visualizing the data.  

*Events* - any event within the application that can be tracked. Events must be assigned a unique name.  
*Metrics* - numeric measurements taken independently of events, typically on an interval. Summarized values of multiple measurements are sent to App Insights rather than every measurement to reduce costs.  

# Monitoring

*Instrumentation* -a method of keeping a record of system performance over time. Three types:
- *Logs* - strings stored in a database 
- *Metrics* - numeric , quantitative values used to determine health of state of a system
- *Traces* - records the path of execution for programs and services

*Telemetry* - series of data measuring the status of key attributes of a system over time

*APM* - Application Performance Monitor
- Agent-Based - Each component in a system runs an agent of the APM which sends data to the APM controller.
- Agentless - Relies on logs and other passive data sources to determine system health.

*Request Saturation Point* - When a server has received more requests or has more items in its queue than it can efficiently proccess  

*USE Metric Correlation Method* 
- `Utilization` - the amount of time over a given interval that a resource is busy
- `Saturation` - A determination of how many requests the resource processed over the same interval, often coupled with a measurement of the size of the queue of unprocessed requests during that time
- `Errors` - The number of unhandled exceptions and unfulfilled requests during that time

*RED Metric Correlation Method*
- `Rate` - The number of requests a service processes over a given interval
- `Errors` - The number of failed requests in the same interval
- `Duration` - The average amount of time required for the service to generate a response to a request

Q: Primary objective of KPI( Key Performance Indictator)?  
A: Notify admins when something goes wrong or is about to go wrong  

Q: What is the basic principle of *Everyday Remediation*?  
A: Use performance metrics of various types to continually improve a system, even when it hasnt't reached a breaking point.  